# PyTorchの概要

## PyTorchとは？
![PyTorch](https://raw.githubusercontent.com/JuvenileTalk9/PyTorch/master/01_PyTorch%E3%81%AE%E6%A6%82%E8%A6%81/pytorch-logo-dark.png)

PyTorchは、Python向けのオープンソースの機械学習ライブラリです。同様のフレームワークとしては、TensorFlow、Keras、Chainerなどがあります。PyTorchの初期リリースは2016年でTensorFlowなどと比較して後発組ですが、以下のGoogleトレンドからも見てわかるように、ここ数年での人気度が急上昇しており、TensorFlowやKerasなどと肩を並べるほどの人気を示しています。

![Googleトレンド](https://raw.githubusercontent.com/JuvenileTalk9/PyTorch/master/01_PyTorch%E3%81%AE%E6%A6%82%E8%A6%81/google_trend.png)

他の機械学習フレームワークと比較したとき、PyTorchの特徴は4つあると思います。

### 特徴1：実装が簡単
PyTorchはTensorという行列形式のデータ型を用います。Tensorの操作感はNumpyとかなり似ており、Numpyを使用した経験があればTensorの操作もすぐに習得できると思います。そしてNumpyと違ってTensorは、GPUで計算するかCPUで計算するか、微分を自動で行うか行わないか、といったディーブラーニングで必須な機能が揃っています。

これらの特徴から、PyTorchは他の機械学習フレームワークと比較して容易に記述が可能です。

### 特徴2：動的な計算グラフの構築
多くのディープラーニングフレームワークは、ニューラルネットワークを「計算グラフ」によって構築しています。計算グラフとは、計算の流れをグラフ構造によって記述したものであり、入力データが畳み込み層、プーリング層、全結合層、活性化関数、ソフトマックス関数を経て、処理結果が確率として出力されるまでの計算の流れを表しています。

計算グラフを構築する方式としては、**Define-and-Run**と**Define-by-Run**の2パターンがあります。

Define-and-Runは計算グラフを静的に計算する方式であり、まず計算グラフを構築し、構築した計算グラフにデータを流すという2ステップからなり、ほとんどのフレームワークがDefine-and-Runを採用しています。計算グラフが固定なため最適化しやすいという利点がありますが、入力サイズを固定にする必要があるため、データごとにネットワークの構造を変えるという手法に対応できないという欠点があります。リサイズにより入力画像サイズを固定にできる画像処理系では欠点が目立ちませんが、自然言語処理などの分野では入力サイズが可変なため、Define-and-Runの方式は不向きです。また、計算の途中結果を確認することは用意ではないため、デバッグが大変という欠点もあります。

PyTorchはDefine-by-Runの方式を採用しています。Define-by-Runは計算グラフを動的に計算する方式であり、順伝搬処理を実行するたびに計算グラフを生成するため、入力や途中の処理結果に応じて分岐するなど、柔軟な計算モデルの構築が可能になります。また、途中の計算結果を確認できるので、デバッグ作業も楽になります。

以下に、Define-and-RunとDefine-by-Runの特徴と採用しているフレームワークをまとめます。

|方式|メリット|デメリット|代表的なフレームワーク|
|:--|:--|:--|:--|
|Define-and-Run|最適化がかけやすい|計算グラフの構造は固定になってしまう|TensorFlow v1<br> Keras <br> Caffe <br> theano|
|Define-by-Run|柔軟な計算グラフの構築が可能 <br> デバッグが容易|計算グラフの構築コストが大きい <br> 最適化をかけづらい|TensorFlow v2 <br> Chainer <br> PyTorch|

### 特徴3：海外コミュニティが活発
PyTorchの実装が他のフレームワークと比較して簡潔なため、PyTorchを使っている機械学習の研究者が増えています。そのため、最新の機械学習の手法や最先端の論文が発表されると、PyTorchによる実装がGitHubに公開されることが少なくありません。PyTorchを学ぶことで、最先端の機械学習技術に触れやすくなるメリットがあります。

### 特徴4：ライブラリが豊富
PyTorchはそのままでもディープラーニングの学習・実行を実装することができますが、追加でライブラリをインストールすることで、より実装が容易になります。

PyTorchのライブラリとしては、画像解析用、音声解析用、自然言語処理用の3つが代表的であり、それそれtorchvision、torchaudio、torchtextという名称のライブラリで整理されています。例えばtorchvisionをインストールすると、MINISTやVOCなどの有名なデータセットのロードや、ResNetやMobileNetなどの代表的なモデルの活用など、強力なAPIが利用でるようになります。


[目次へ戻る](https://github.com/JuvenileTalk9/PyTorch)
